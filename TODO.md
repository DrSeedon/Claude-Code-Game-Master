# TODO — DM System

## Quest System
- [ ] `dm-plot.sh add` — создание квестов через CLI (сейчас только ручной JSON)
- [ ] `dm-plot.sh objectives` — отметка выполненных целей внутри квеста
- [ ] `/dm quests` — отображение активных квестов игроку в красивом формате

## Map System
- [ ] `dm-map.sh` — полноценная ASCII-карта мира (глобальная) с координатами и масштабом
- [ ] Подкарты (submaps) — вложенные карты для локаций/объектов:
  - [ ] Интерьеры зданий, бункеров, пещер
  - [ ] Палубы космических кораблей / станций
  - [ ] Этажи подземелий
  - [ ] Переключение между глобальной картой и подкартой (`dm-map.sh --submap "Корабль"`)
- [ ] Связь между уровнями: лестницы, лифты, шлюзы, люки
- [ ] Хранение подкарт в `locations.json` (поле `submap` или отдельный `submaps.json`)

## Inventory System (Weight & Slots)
- [ ] `inventory.json` — отдельный файл вместо списка строк в `character.json`
  - [ ] Каждый предмет: `id`, `name`, `weight_kg`, `quantity`, `stackable`, `category`
  - [ ] Категории: weapon, ammo, medical, food, consumable, quest, junk, armor
  - [ ] Стакинг: патроны, бинты, еда суммируются автоматически
- [ ] Система веса:
  - [ ] Макс. грузоподъёмность = STR × 7 кг (базовая)
  - [ ] Рюкзак добавляет +10-15 кг к лимиту
  - [ ] Перегруз: скорость ×0.5, disadvantage на DEX, -2 к Скрытности
  - [ ] Критический перегруз (×2 лимита): движение 5ft/раунд
- [ ] `dm-player.sh inventory` — переписать на работу с `inventory.json`
  - [ ] `dm-player.sh inventory add "item" --qty 5` — добавление с количеством
  - [ ] `dm-player.sh inventory drop "item"` — выбросить (не удалить!)
  - [ ] `dm-player.sh inventory weight` — показать текущий вес / лимит
  - [ ] `dm-player.sh inventory list --category weapon` — фильтр по категории
- [ ] Автообъединение при добавлении (патроны 9мм + патроны 9мм = одна строка)
- [ ] Миграция: скрипт конвертации старого `equipment[]` в `inventory.json`
